<!doctype html>
<html lang="sr">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Golem AI - Va≈° Liƒçni Turistiƒçki Asistent</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'tourism-primary': '#0891b2',
              'tourism-secondary': '#f97316',
              'tourism-accent': '#f59e0b'
            }
          }
        }
      }
    </script>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-slate-50 to-blue-50">
    <div id="chat-root" class="min-h-screen">
      <!-- Chat Interface -->
      <div class="flex flex-col h-screen max-w-4xl mx-auto">
        <!-- Header -->
        <header class="bg-white/80 backdrop-blur-md border-b border-gray-200/50 p-4 sticky top-0 z-10">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <div class="w-10 h-10 bg-gradient-to-r from-tourism-primary to-tourism-secondary rounded-full flex items-center justify-center">
                <span class="text-white font-bold text-lg">G</span>
              </div>
              <div>
                <h1 class="text-xl font-bold text-gray-800">Golem AI</h1>
                <p class="text-sm text-gray-600">Va≈° Liƒçni Turistiƒçki Asistent</p>
              </div>
            </div>
            <a href="/" class="text-tourism-primary hover:text-tourism-secondary transition-colors">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </a>
          </div>
        </header>

        <!-- Messages Container -->
        <div id="messages-container" class="flex-1 overflow-y-auto p-6 space-y-4">
          <!-- Welcome Message -->
          <div class="flex items-start space-x-3">
            <div class="w-8 h-8 bg-gradient-to-r from-tourism-primary to-tourism-secondary rounded-full flex items-center justify-center flex-shrink-0">
              <span class="text-white font-bold text-sm">G</span>
            </div>
            <div class="bg-white rounded-2xl rounded-tl-md p-4 shadow-sm border border-gray-100 max-w-md">
              <p class="text-gray-800">Zdravo! Ja sam Golem, va≈° AI turistiƒçki asistent. Kako mogu da vam pomognem da pronaƒëete savr≈°eno putovanje? üåç‚úàÔ∏è</p>
            </div>
          </div>
        </div>

        <!-- User Info Modal -->
        <div id="user-info-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
          <div class="bg-white rounded-2xl p-6 w-full max-w-md animate-fade-in">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Informacije o korisniku</h2>
            <p class="text-gray-600 mb-6">Molimo vas da unesete va≈°e podatke pre rezervacije:</p>
            <form id="user-info-form" class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Ime i prezime</label>
                <input type="text" id="full-name" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-tourism-primary focus:border-transparent">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Email adresa</label>
                <input type="email" id="email" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-tourism-primary focus:border-transparent">
              </div>
              <div class="flex space-x-3">
                <button type="submit" class="flex-1 bg-gradient-to-r from-tourism-primary to-tourism-secondary text-white py-3 rounded-lg font-medium hover:opacity-90 transition-opacity">
                  Saƒçuvaj
                </button>
                <button type="button" id="cancel-user-info" class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                  Otka≈æi
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Input Area -->
        <div class="border-t border-gray-200/50 bg-white/80 backdrop-blur-md p-4">
          <div class="flex items-center space-x-3">
            <div class="flex-1">
              <input 
                type="text" 
                id="message-input"
                placeholder="Napi≈°ite va≈°u poruku..."
                class="w-full px-4 py-3 border border-gray-300 rounded-full focus:ring-2 focus:ring-tourism-primary focus:border-transparent resize-none"
                onkeypress="handleKeyPress(event)"
              >
            </div>
            <button 
              id="send-button"
              onclick="sendMessage()"
              class="bg-gradient-to-r from-tourism-primary to-tourism-secondary text-white p-3 rounded-full hover:opacity-90 transition-opacity disabled:opacity-50"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      let userInfo = null;
      let conversationHistory = [];

      function handleKeyPress(event) {
        if (event.key === 'Enter') {
          sendMessage();
        }
      }

      function showUserInfoModal() {
        document.getElementById('user-info-modal').classList.remove('hidden');
      }

      function hideUserInfoModal() {
        document.getElementById('user-info-modal').classList.add('hidden');
      }

      document.getElementById('cancel-user-info').onclick = hideUserInfoModal;

      document.getElementById('user-info-form').onsubmit = function(e) {
        e.preventDefault();
        userInfo = {
          fullName: document.getElementById('full-name').value,
          email: document.getElementById('email').value
        };
        hideUserInfoModal();
        addMessage('system', `Hvala ${userInfo.fullName}! Sada mo≈æemo da nastavimo sa rezervacijom.`);
      };

      function addMessage(sender, content, isLoading = false) {
        const messagesContainer = document.getElementById('messages-container');
        const messageDiv = document.createElement('div');
        
        if (sender === 'user') {
          messageDiv.innerHTML = `
            <div class="flex items-start space-x-3 justify-end">
              <div class="bg-gradient-to-r from-tourism-primary to-tourism-secondary text-white rounded-2xl rounded-tr-md p-4 shadow-sm max-w-md">
                <p>${content}</p>
              </div>
              <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center flex-shrink-0">
                <span class="text-gray-600 font-bold text-sm">Vi</span>
              </div>
            </div>
          `;
        } else {
          messageDiv.innerHTML = `
            <div class="flex items-start space-x-3">
              <div class="w-8 h-8 bg-gradient-to-r from-tourism-primary to-tourism-secondary rounded-full flex items-center justify-center flex-shrink-0">
                <span class="text-white font-bold text-sm">G</span>
              </div>
              <div class="bg-white rounded-2xl rounded-tl-md p-4 shadow-sm border border-gray-100 max-w-md">
                <p class="text-gray-800">${isLoading ? '<span class="animate-pulse">Golem razmi≈°lja...</span>' : content}</p>
              </div>
            </div>
          `;
        }
        
        messagesContainer.appendChild(messageDiv);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
        
        return messageDiv;
      }

      async function sendMessage() {
        const input = document.getElementById('message-input');
        const message = input.value.trim();
        
        if (!message) return;
        
        // Add user message
        addMessage('user', message);
        input.value = '';
        
        // Add loading message
        const loadingMsg = addMessage('golem', '', true);
        
        // Check if message contains booking intent
        const bookingKeywords = ['rezervacija', 'rezervi≈°i', '≈æelim da rezervi≈°em', 'booking', 'book'];
        const hasBookingIntent = bookingKeywords.some(keyword => message.toLowerCase().includes(keyword));
        
        if (hasBookingIntent && !userInfo) {
          loadingMsg.remove();
          showUserInfoModal();
          return;
        }
        
        try {
          // Simulate AI response
          setTimeout(() => {
            loadingMsg.remove();
            
            let response = generateGolemResponse(message);
            addMessage('golem', response);
          }, 1500);
          
        } catch (error) {
          loadingMsg.remove();
          addMessage('golem', 'Izvinjavam se, do≈°lo je do gre≈°ke. Molimo poku≈°ajte ponovo.');
        }
      }

      function generateGolemResponse(message) {
        const msg = message.toLowerCase();
        
        if (msg.includes('destinacija') || msg.includes('gde') || msg.includes('putovanje')) {
          return 'Odliƒço pitanje! Mogu da vam preporuƒçim neke fantastiƒçne destinacije. Da li preferirate: <br>üèñÔ∏è Tropske pla≈æe<br>üèîÔ∏è Planinske avanture<br>üèõÔ∏è Kulturne ture<br>üåÜ Gradske destinacije<br><br>Takoƒëe, koji je va≈° bud≈æet i kada planirate putovanje?';
        }
        
        if (msg.includes('bud≈æet') || msg.includes('cena') || msg.includes('koliko')) {
          return 'Razumem, bud≈æet je va≈æan faktor! Mogu da vam ponudim opcije u razliƒçitim cenovnim rangovima:<br><br>üí∞ Ekonomske opcije (500-1000‚Ç¨)<br>üíé Komforne opcije (1000-2500‚Ç¨)<br>üåü Luksuzne opcije (2500‚Ç¨+)<br><br>Koji rang vam odgovara?';
        }
        
        if (msg.includes('rezervacija') || msg.includes('rezervi≈°i')) {
          return 'Odliƒçno! Spremni smo za rezervaciju. Mogu da vam pomognem sa:<br><br>‚úàÔ∏è Rezervacija letova<br>üè® Rezervacija hotela<br>üéØ Kompletni paketi<br>üöó Rent-a-car usluge<br><br>≈†ta vas najvi≈°e zanima?';
        }
        
        if (msg.includes('pla≈æa') || msg.includes('more')) {
          return 'Fantastiƒçan izbor! Evo nekih neverovatnih primorskih destinacija:<br><br>üá¨üá∑ Grƒçka - Santorini, Mikonos<br>üá≠üá∑ Hrvatska - Dubrovnik, Split<br>üá™üá∏ ≈†panija - Ibiza, Costa del Sol<br>üáπüá≠ Tajland - Phuket, Koh Samui<br><br>Da li imate preference za odreƒëenu destinaciju?';
        }
        
        return 'Hvala na va≈°oj poruci! Kao va≈° AI turistiƒçki asistent, mogu da vam pomognem sa:<br><br>üåç Preporuƒçivanje destinacija<br>‚úàÔ∏è Planiranje putovanja<br>üè® Rezervacije sme≈°taja<br>üí° Turistiƒçki saveti<br><br>O ƒçemu ≈æelite da razgovaramo?';
      }

      // Initial setup
      document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('message-input').focus();
      });
    </script>
  </body>
</html>